"use strict";

require("core-js/modules/es.promise");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.waitForNavigation = waitForNavigation;
exports.waitForNavigationAndDomLoad = waitForNavigationAndDomLoad;
exports.getCurrentUrl = getCurrentUrl;
exports.waitForRedirect = waitForRedirect;

var _waiting = require("./waiting");

async function waitForNavigation(page, options) {
  await page.waitForNavigation(options);
}

async function waitForNavigationAndDomLoad(page) {
  await waitForNavigation(page, {
    waitUntil: 'domcontentloaded'
  });
}

async function getCurrentUrl(page, clientSide = false) {
  if (clientSide) {
    return page.evaluate(() => window.location.href);
  }

  return page.url();
}

async function waitForRedirect(page, timeout = 20000, clientSide = false, ignoreList = []) {
  const initial = await getCurrentUrl(page, clientSide);
  await (0, _waiting.waitUntil)(async () => {
    const current = await getCurrentUrl(page, clientSide);
    return current !== initial && !ignoreList.includes(current);
  }, `waiting for redirect from ${initial}`, timeout, 1000);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9oZWxwZXJzL25hdmlnYXRpb24udHMiXSwibmFtZXMiOlsid2FpdEZvck5hdmlnYXRpb24iLCJwYWdlIiwib3B0aW9ucyIsIndhaXRGb3JOYXZpZ2F0aW9uQW5kRG9tTG9hZCIsIndhaXRVbnRpbCIsImdldEN1cnJlbnRVcmwiLCJjbGllbnRTaWRlIiwiZXZhbHVhdGUiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsImhyZWYiLCJ1cmwiLCJ3YWl0Rm9yUmVkaXJlY3QiLCJ0aW1lb3V0IiwiaWdub3JlTGlzdCIsImluaXRpYWwiLCJjdXJyZW50IiwiaW5jbHVkZXMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUNBOztBQUVPLGVBQWVBLGlCQUFmLENBQWlDQyxJQUFqQyxFQUE2Q0MsT0FBN0MsRUFBMEU7QUFDL0UsUUFBTUQsSUFBSSxDQUFDRCxpQkFBTCxDQUF1QkUsT0FBdkIsQ0FBTjtBQUNEOztBQUVNLGVBQWVDLDJCQUFmLENBQTJDRixJQUEzQyxFQUF1RDtBQUM1RCxRQUFNRCxpQkFBaUIsQ0FBQ0MsSUFBRCxFQUFPO0FBQUVHLElBQUFBLFNBQVMsRUFBRTtBQUFiLEdBQVAsQ0FBdkI7QUFDRDs7QUFFTSxlQUFlQyxhQUFmLENBQTZCSixJQUE3QixFQUF5Q0ssVUFBVSxHQUFHLEtBQXRELEVBQTZEO0FBQ2xFLE1BQUlBLFVBQUosRUFBZ0I7QUFDZCxXQUFPTCxJQUFJLENBQUNNLFFBQUwsQ0FBYyxNQUFNQyxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JDLElBQXBDLENBQVA7QUFDRDs7QUFFRCxTQUFPVCxJQUFJLENBQUNVLEdBQUwsRUFBUDtBQUNEOztBQUVNLGVBQWVDLGVBQWYsQ0FBK0JYLElBQS9CLEVBQTJDWSxPQUFPLEdBQUcsS0FBckQsRUFDTFAsVUFBVSxHQUFHLEtBRFIsRUFDZVEsVUFBb0IsR0FBRyxFQUR0QyxFQUMwQztBQUMvQyxRQUFNQyxPQUFPLEdBQUcsTUFBTVYsYUFBYSxDQUFDSixJQUFELEVBQU9LLFVBQVAsQ0FBbkM7QUFFQSxRQUFNLHdCQUFVLFlBQVk7QUFDMUIsVUFBTVUsT0FBTyxHQUFHLE1BQU1YLGFBQWEsQ0FBQ0osSUFBRCxFQUFPSyxVQUFQLENBQW5DO0FBQ0EsV0FBT1UsT0FBTyxLQUFLRCxPQUFaLElBQXVCLENBQUNELFVBQVUsQ0FBQ0csUUFBWCxDQUFvQkQsT0FBcEIsQ0FBL0I7QUFDRCxHQUhLLEVBR0YsNkJBQTRCRCxPQUFRLEVBSGxDLEVBR3FDRixPQUhyQyxFQUc4QyxJQUg5QyxDQUFOO0FBSUQiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOYXZpZ2F0aW9uT3B0aW9ucywgUGFnZSB9IGZyb20gJ3B1cHBldGVlcic7XG5pbXBvcnQgeyB3YWl0VW50aWwgfSBmcm9tICcuL3dhaXRpbmcnO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gd2FpdEZvck5hdmlnYXRpb24ocGFnZTogUGFnZSwgb3B0aW9ucz86IE5hdmlnYXRpb25PcHRpb25zKSB7XG4gIGF3YWl0IHBhZ2Uud2FpdEZvck5hdmlnYXRpb24ob3B0aW9ucyk7XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB3YWl0Rm9yTmF2aWdhdGlvbkFuZERvbUxvYWQocGFnZTogUGFnZSkge1xuICBhd2FpdCB3YWl0Rm9yTmF2aWdhdGlvbihwYWdlLCB7IHdhaXRVbnRpbDogJ2RvbWNvbnRlbnRsb2FkZWQnIH0pO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q3VycmVudFVybChwYWdlOiBQYWdlLCBjbGllbnRTaWRlID0gZmFsc2UpIHtcbiAgaWYgKGNsaWVudFNpZGUpIHtcbiAgICByZXR1cm4gcGFnZS5ldmFsdWF0ZSgoKSA9PiB3aW5kb3cubG9jYXRpb24uaHJlZik7XG4gIH1cblxuICByZXR1cm4gcGFnZS51cmwoKTtcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdhaXRGb3JSZWRpcmVjdChwYWdlOiBQYWdlLCB0aW1lb3V0ID0gMjAwMDAsXG4gIGNsaWVudFNpZGUgPSBmYWxzZSwgaWdub3JlTGlzdDogc3RyaW5nW10gPSBbXSkge1xuICBjb25zdCBpbml0aWFsID0gYXdhaXQgZ2V0Q3VycmVudFVybChwYWdlLCBjbGllbnRTaWRlKTtcblxuICBhd2FpdCB3YWl0VW50aWwoYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IGN1cnJlbnQgPSBhd2FpdCBnZXRDdXJyZW50VXJsKHBhZ2UsIGNsaWVudFNpZGUpO1xuICAgIHJldHVybiBjdXJyZW50ICE9PSBpbml0aWFsICYmICFpZ25vcmVMaXN0LmluY2x1ZGVzKGN1cnJlbnQpO1xuICB9LCBgd2FpdGluZyBmb3IgcmVkaXJlY3QgZnJvbSAke2luaXRpYWx9YCwgdGltZW91dCwgMTAwMCk7XG59XG4iXX0=